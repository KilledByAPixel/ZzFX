// ZzFX - Zuper Zmall Zound Zynth - Minified Version - MIT License - Copyright 2019 Frank Force
"use strict"; // strict mode
function ZZFXLib(){this.x=new AudioContext;this.r=Date.now();this.buffer=0;this.volume=.5;this.randomness=.1;this.z=function(a,d){let b=this.Generate(a),c;for(c in d)b[c]=d[c];return this.Z(b.volume,b.randomness,b.frequency,b.length,b.attack,b.slide,b.noise,b.modulation,b.modulationPhase)};this.Z=function(a,d,b,c=1,e=.1,k=0,h=0,l=0,m=0){let f=2*Math.PI;a*=this.volume;b=f/44100*b*(1+d*(2*Math.random()-1));k*=500*f/Math.pow(44100,2);c=0<c?44100*(10<c?10:c)|0:1;e=e*c|0;l*=f/44100;m*=f/2;d=[];for(let n=f=0,g=0;g<c;++g)d[g]=a*Math.cos(f*b*Math.cos(n*l+m))*(g<e?g/e:1-(g-e)/(c-e)),f+=1+h*(2*Math.random()-1),n+=1+h*(2*Math.random()-1),b+=k;this.buffer=d;a=this.x.createBuffer(1,d.length,44100);b=this.x.createBufferSource();a.getChannelData(0).set(d);b.buffer=a;b.connect(this.x.destination);b.start();return b};this.Generate=function(a){let d=this.r;this.r=a;for(let b=9;b--;)this.R();a={seed:a,volume:1,randomness:a?this.randomness:0,frequency:a?2E3*Math.pow(this.R(),2)|0:220,slide:a?(10*Math.pow(this.R(),3)).toFixed(1):0,length:a?(.1+this.R()).toFixed(1):1,attack:a?this.R().toFixed(2):.1,noise:a?(5*Math.pow(this.R(),3)).toFixed(1):0,modulation:a?(99*Math.pow(this.R(),5)).toFixed(1):0,modulationPhase:a?this.R().toFixed(2):0};this.r=d;return a};this.Note=function(a,d){return a*Math.pow(2,d/12)};this.R=function(){this.r^=this.r<<13;this.r^=this.r>>7;this.r^=this.r<<17;return Math.abs(this.r)%1E9/1E9}};let ZZFX=new ZZFXLib;